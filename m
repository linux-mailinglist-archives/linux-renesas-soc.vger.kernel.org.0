Return-Path: <linux-renesas-soc-owner@vger.kernel.org>
X-Original-To: lists+linux-renesas-soc@lfdr.de
Delivered-To: lists+linux-renesas-soc@lfdr.de
Received: from vger.kernel.org (vger.kernel.org [209.132.180.67])
	by mail.lfdr.de (Postfix) with ESMTP id 458F8136441
	for <lists+linux-renesas-soc@lfdr.de>; Fri, 10 Jan 2020 01:13:55 +0100 (CET)
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
        id S1730042AbgAJANz (ORCPT <rfc822;lists+linux-renesas-soc@lfdr.de>);
        Thu, 9 Jan 2020 19:13:55 -0500
Received: from relmlor2.renesas.com ([210.160.252.172]:32546 "EHLO
        relmlie6.idc.renesas.com" rhost-flags-OK-OK-OK-FAIL)
        by vger.kernel.org with ESMTP id S1730001AbgAJANy (ORCPT
        <rfc822;linux-renesas-soc@vger.kernel.org>);
        Thu, 9 Jan 2020 19:13:54 -0500
Date:   10 Jan 2020 09:13:53 +0900
X-IronPort-AV: E=Sophos;i="5.69,414,1571670000"; 
   d="scan'208";a="36109116"
Received: from unknown (HELO relmlir5.idc.renesas.com) ([10.200.68.151])
  by relmlie6.idc.renesas.com with ESMTP; 10 Jan 2020 09:13:53 +0900
Received: from morimoto-PC.renesas.com (unknown [10.166.18.140])
        by relmlir5.idc.renesas.com (Postfix) with ESMTP id 58238400D0EF;
        Fri, 10 Jan 2020 09:13:53 +0900 (JST)
Message-ID: <87d0bstbge.wl-kuninori.morimoto.gx@renesas.com>
From:   Kuninori Morimoto <kuninori.morimoto.gx@renesas.com>
To:     Geert Uytterhoeven <geert@linux-m68k.org>
Cc:     Yoshinori Sato <ysato@users.sourceforge.jp>,
        Rich Felker <dalias@libc.org>,
        Andrew Morton <akpm@linux-foundation.org>,
        Linux-SH <linux-sh@vger.kernel.org>,
        Linux-Renesas <linux-renesas-soc@vger.kernel.org>
Subject: Re: [PATCH][repost] sh: clkfwk: remove r8/r16/r32
In-Reply-To: <CAMuHMdWo2w=Uf-yKReg+BMjKk4otGqG0DE4urtWhVOTE9+o1kw@mail.gmail.com>
References: <87o8vdsceg.wl-kuninori.morimoto.gx@renesas.com>
        <87lfqhscac.wl-kuninori.morimoto.gx@renesas.com>
        <CAMuHMdWo2w=Uf-yKReg+BMjKk4otGqG0DE4urtWhVOTE9+o1kw@mail.gmail.com>
User-Agent: Wanderlust/2.15.9 Emacs/24.5 Mule/6.0
MIME-Version: 1.0 (generated by SEMI-EPG 1.14.7 - "Harue")
Content-Type: text/plain; charset=US-ASCII
Sender: linux-renesas-soc-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-renesas-soc.vger.kernel.org>
X-Mailing-List: linux-renesas-soc@vger.kernel.org


Hi Geert

> > From: Kuninori Morimoto <kuninori.morimoto.gx@renesas.com>
> >
> > SH will get below warning
> >
> > ${LINUX}/drivers/sh/clk/cpg.c: In function 'r8':
> > ${LINUX}/drivers/sh/clk/cpg.c:41:17: warning: passing argument 1 of 'ioread8'
> >  discards 'const' qualifier from pointer target type [-Wdiscarded-qualifiers]
> >   return ioread8(addr);
> >                  ^~~~
> > In file included from ${LINUX}/arch/sh/include/asm/io.h:21,
> >                  from ${LINUX}/include/linux/io.h:13,
> >                  from ${LINUX}/drivers/sh/clk/cpg.c:14:
> > ${LINUX}/include/asm-generic/iomap.h:29:29: note: expected 'void *' but
> > argument is of type 'const void *'
> >  extern unsigned int ioread8(void __iomem *);
> >                              ^~~~~~~~~~~~~~
> >
> > We don't need "const" for r8/r16/r32.
> > And we don't need r8/r16/r32 themselvs.
> > This patch cleanup these.
> >
> > Signed-off-by: Kuninori Morimoto <kuninori.morimoto.gx@renesas.com>
> 
> Reviewed-by: Geert Uytterhoeven <geert+renesas@glider.be>

Thanks

> >  static int sh_clk_mstp_enable(struct clk *clk)
> >  {
> >         sh_clk_write(sh_clk_read(clk) & ~(1 << clk->enable_bit), clk);
> >         if (clk->status_reg) {
> > -               unsigned int (*read)(const void __iomem *addr);
> > +               unsigned int (*read)(void __iomem *addr);
> 
> While it is good to get rid of the wrappers, the change above will conflict with
> [PATCH v2 1/9] iomap: Constify ioreadX() iomem argument (as in generic
> implementation)
> (https://lore.kernel.org/lkml/20200108200528.4614-2-krzk@kernel.org/),
> which will add const to ioread*().

Oh, I see.
Will consider about it, and post v2

Thank you for your help !!
Best regards
---
Kuninori Morimoto
